import { VersionedMessage, VersionedTransaction } from '@solana/web3.js'
import bs58 from 'bs58'

const txData = [
  {
    "point": {
      "eid": 30168,
      "address": "A28EK6j1euK4e6taP1KLFpGEoR1mDpXR4vtfiyCE1Nxv"
    },
    "data": "020003083c1b094729102e0c095ee2417e5940ee4f1eab4763f6113fe75281ab74c62398d686ca6c5f329a8001280fc5746b81b4d7adbe81cd03aecb55686030d043869051f298c947055df90b07fd4349c8d74f026b2c0dccb1304eab486926a4c7e4996e86145c006a0a502f82f319f04eb2cdea8d17882e5824ae80ac4862438d34fae28c0bac798e163b58838f0f6c7985b2ff620053ec73ebb925eee4cabafc425e00000000000000000000000000000000000000000000000000000000000000008602f005ca65b6da46a3c6ce66ecd1d15be911ca650d5f418d369df184b584cfc15627c37a10f89f1c6fc7fedd83ebbdd82cbddd14df55674498ec9c1eae1b31d58d50d869bd2ae42e78127145bd2d5c5ecb322988e85e339070cb0fc6a2075e03070401020605414fbba8398b8c5d2f95750000021600000000030100110100000000000000000000000000030d401600000000030100110100000000000000000000000000030d40070401030605414fbba8398b8c5d2fe7750000021600000000030100110100000000000000000000000000030d401600000000030100110100000000000000000000000000030d40070401040605414fbba8398b8c5d2f9a760000021600000000030100110100000000000000000000000000030d401600000000030100110100000000000000000000000000030d40",
    "description": "Setting enforced options to [\n\t{\n\t\t\"eid\": 30101,\n\t\t\"option\": {\n\t\t\t\"msgType\": 1,\n\t\t\t\"options\": \"0x00030100110100000000000000000000000000030d40\"\n\t\t}\n\t},\n\t{\n\t\t\"eid\": 30101,\n\t\t\"option\": {\n\t\t\t\"msgType\": 2,\n\t\t\t\"options\": \"0x00030100110100000000000000000000000000030d40\"\n\t\t}\n\t},\n\t{\n\t\t\"eid\": 30183,\n\t\t\"option\": {\n\t\t\t\"msgType\": 1,\n\t\t\t\"options\": \"0x00030100110100000000000000000000000000030d40\"\n\t\t}\n\t},\n\t{\n\t\t\"eid\": 30183,\n\t\t\"option\": {\n\t\t\t\"msgType\": 2,\n\t\t\t\"options\": \"0x00030100110100000000000000000000000000030d40\"\n\t\t}\n\t},\n\t{\n\t\t\"eid\": 30362,\n\t\t\"option\": {\n\t\t\t\"msgType\": 1,\n\t\t\t\"options\": \"0x00030100110100000000000000000000000000030d40\"\n\t\t}\n\t},\n\t{\n\t\t\"eid\": 30362,\n\t\t\"option\": {\n\t\t\t\"msgType\": 2,\n\t\t\t\"options\": \"0x00030100110100000000000000000000000000030d40\"\n\t\t}\n\t}\n]"
  }
]

const transactionDataHex = '020103073c1b094729102e0c095ee2417e5940ee4f1eab4763f6113fe75281ab74c62398d686ca6c5f329a8001280fc5746b81b4d7adbe81cd03aecb55686030d04386902b8e4682d3f411e70817a79aef8f6b969692305f6eeb8310604489de6381e18c3290f7cb566e3551d3b61847d7de7ecef11c221abd502eb1f4009e9b72f5926e5aad76da514b6e1dcf11037e904dac3d375f525c9fbafcb19507b78907d8c18bc15627c37a10f89f1c6fc7fedd83ebbdd82cbddd14df55674498ec9c1eae1b31d1dd86ac361b6252c406c281f3912ab13b924126c011b587278e8af0b08ef09bfc8d3cd68bf26fe6925aa5e92adcc00c6e58feb179cb13a22a1938a92a3dda760105070103040302060429377e57d99f4218c2013c1b094729102e0c095ee2417e5940ee4f1eab4763f6113fe75281ab74c62398'
const versionedMessage = VersionedMessage.deserialize(Buffer.from(transactionDataHex, 'hex'))

txData.forEach(_tx => {
    const tx = new VersionedTransaction(VersionedMessage.deserialize(Buffer.from(_tx.data, 'hex')));
    console.log(_tx.description)
    console.log(bs58.encode(Buffer.from(tx.serialize())))
});